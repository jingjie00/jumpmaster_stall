<!DOCTYPE html>

<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<title>Shopping Cart</title>
	<link rel="manifest" href="manifest.json">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="application-name" content="Jumpmaster Stall">
	<meta name="apple-mobile-web-app-title" content="Jumpmaster Stall">
	<meta name="theme-color" content="#FF9800">
	<meta name="msapplication-navbutton-color" content="#FF9800">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="msapplication-starturl" content="/index.html">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- mobile responsive meta -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

	<!-- Bootstrap -->
	<link rel="stylesheet" href="plugins/bootstrap/bootstrap.min.css">
	<link rel="stylesheet" href="plugins/themify/css/themify-icons.css">
	<link rel="stylesheet" href="plugins/icofont/icofont.min.css">
	<link rel="stylesheet" href="plugins/fontawesome/css/all.css">
	<link rel="stylesheet" href="plugins/aos/aos.css">
	<link rel="stylesheet" href="plugins/magnific-popup/magnific-popup.css">
	<link rel="stylesheet" href="plugins/video-popup/modal-video.min.css">
	<link rel="stylesheet" href="plugins/swiper/swiper.min.css">
	<link rel="stylesheet" href="plugins/date-picker/datepicker.min.css">
	<link rel="stylesheet" href="plugins/clock-picker/clockpicker.min.css">
	<link rel="stylesheet" href="plugins/bootstrap-touchpin/jquery.bootstrap-touchspin.min.css">
	<link rel="stylesheet" href="plugins/devices.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css" />
	<script type='text/javascript'
		src='https://platform-api.sharethis.com/js/sharethis.js#property=5f49ccb7f73f72001282f8ed&product=sop'
		async='async'></script>
	<link href="css/style.css" rel="stylesheet">
	<script src="https://smtpjs.com/v3/smtp.js">
	</script>

	<!--Favicon-->
	<link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
	<link rel="icon" href="images/favicon.png" type="image/x-icon">
	<style>
		html {
			scroll-behavior: smooth;
		}

		#logo {
			animation: bounce infinite;
			animation-duration: 1s;
		}


		.mapouter {
			position: relative;
			text-align: right;
			height: 206px;
			width: 372px;
		}

		.gmap_canvas {
			overflow: hidden;
			background: none !important;
			height: 206px;
			width: 372px;
		}



		.cart {

			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
		}

		.sticky {

			position: -webkit-sticky;
			position: sticky;
			z-index: 999999999;
			top: 0;
			width: 100%;

		}

		.gmap_canvas iframe {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
		}
	</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


</head>

<!-- Header Start -->
<!-- Nav Bar-->
<header class="navigation" id="myheader">
	<nav class="sticky navbar navbar-expand-lg main-nav py-lg-3 position-absolute w-100" id="main-nav" style="background: url('./images/bg/bg-2.jpg') 10% 10% no-repeat;
		background-size: cover;">

		<div class="container">
			<a class="navbar-brand" href="index.html">
				<img id="logo" src="images/logo.png" alt="" class="img-fluid">
			</a>

			<button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navigation"
				aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
				<span class="fa fa-bars"></span>
			</button>

			<div class="collapse navbar-collapse" id="navigation">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item active">
						<a class="nav-link" href="index.html">Home</a>
					</li>
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" aria-haspopup="true"
							aria-expanded="false">Info</a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="about.html">About Us </a></li>
							<li><a class="dropdown-item" href="contact.html">Contact us</a></li>
						</ul>
					</li>
					<li class="nav-item active">
						<a class="nav-link" href="weather.html">Weather</a>
					</li>
					<li class="nav-item active">
						<a class="nav-link" href="past-order.html">Past Orders</a>
					</li>
					<li class="nav-item active">
						<a class="nav-link" href="product.html">Product</a>
					</li>
					<li class="nav-item active">
						<a class="nav-link shopping-cart" href="cart.html">Cart</a>
					</li>
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" aria-haspopup="true"
							aria-expanded="false">Reservation</a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="shipping.html">Shipping</a></li>
							<li><a class="dropdown-item" href="payment.html">Payment</a></li>
							<li><a class="dropdown-item" href="confirmation.html">Confirmation</a></li>
						</ul>
					</li>


					<li class="nav-item">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
					<li><button id="detail" type="button" class="btn btn-warning" data-toggle="modal"
							data-target="#myModal">
							My detail
						</button></li>


				</ul>
			</div>
</header>

<!-- The User detail -->
<div class="modal" id="myModal">
	<div class="modal-dialog">
		<div class="modal-content">

			<!-- Modal Header -->
			<div class="modal-header">
				<h4 class="modal-title">Hi customer</h4>
				<button type="button" class="close" data-dismiss="modal">&times;</button>
			</div>
			<div id="alert">

			</div>
			<!-- Modal body -->
			<div class="modal-body">
				<div class="form-group">
					<label class="control-label">Name:</label>
					<div class="input-group mb-3">
						<div class="input-group-prepend">
							<div class="dropdown">
								<button id="select_button" class="btn btn-secondary dropdown-toggle" type="button">
									Select:
								</button>
								<div id="name_select" class="dropdown-menu">

								</div>
							</div>
						</div>
						<input id="name" type="text" class="form-control">
					</div>
				</div>
				<div id="valid">
					<div class="form-group">
						<label class="control-label">Address:</label>
						<div class="input-group">
							<input id="address" type="text" class="form-control">
							<div class="input-group-append">
								<button id="location" class="btn btn-dark">From map</button>
							</div>
						</div>
					</div>
					<div class="form-group">
						<label class="control-label">Email:</label>
						<input id="email" type="text" class="form-control">
					</div>
					<div class="form-check">
						<input id="check" type="checkbox" class="form-check-input">
						<label class="form-check-label">Remember me.(Save
							into local Storage)</label>
					</div>

				</div>
			</div>

			<!-- Modal footer -->
			<div class="modal-footer">
				<button id="clearsession" type="button" class="btn btn-warning">Clear my session
				</button>
				<div id="saveedit">
				</div>
			</div>

		</div>
	</div>
</div>
<!-- Header Close -->

<!-- Cart Page Banner Starts -->
<section class="section-header bg-1">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="text-center">
					<h1 class="text-capitalize mb-4 font-lg text-white">Cart Page</h1>
				</div>
			</div>
		</div>
	</div>
</section>
<!-- Cart Page Banner Ends -->


<section class="section cart">
	<div id="myCont">
		<div class="container">
			<div class="row justify-content-end">
				<div class="col-lg-12">
					<div class="table-responsive">
						<table class="table text-center table-cart">
							<thead>
								<tr>
									<!-- Initialise Table Headers -->
									<th scope="col" colspan="2">product name</th>
									<th scope="col">price</th>
									<th scope="col">quantity</th>
									<th scope="col">subtotal</th>
									<th scope="col"></th>
								</tr>
							</thead>
							<tbody id="producttable">

								<!--  This is where the products will be listed in rows -->
							</tbody>
						</table>
					</div>
				</div>

				<!--  Order Summary -->
				<div class="col-md-6 col-lg-6 mt-4">
					<div class="px-xl-5 py-4 card border-0 ">
						<div class="">
							<h4 class="text-dark font-size-20">Order Summary</h4>
							<hr>
							<p>Goods will be delivered within one hour of payment. *Subjected to location.</p>
						</div>

						<div class="media align-items-center border-bottom font-weight-medium py-3">
							<div class="media-body">
								<span class="text-black">Subtotal</span>
							</div>
							<span class="text-dark" id="subtotal">$0</span>
						</div>

						<div class="media align-items-center border-bottom font-weight-medium py-3">
							<div class="media-body">
								<span class="text-black">Shipping &amp; Tax</span>
							</div>
							<span class="text-dark" id="vat">$0</span>
						</div>

						<div class="media justify-content-between align-items-center py-3">
							<span class="text-dark ">Grand Total</span>
							<span class="text-dark font-weight-bold" id="grandtotal">$0</span>
						</div>

						<!--  Let's go to Payment! -->
						<a href="shipping.html" class="btn btn-main mt-4">
							Proceed to checkout
						</a>
					</div>
				</div>
			</div>
		</div>

	</div>

</section>

<!--Footer start -->
<footer class="section footer">
	<div class="container">
		<div class="row justify-content-center">
			<div class="col-lg-4 col-md-3 mb-5 mb-lg-0">
				<div class="widget">
					<h4 class="mb-3">About</h4>
					<p>JumpMasters hopes to bring you the better best of Malaysia's cusines. Indulge in your
						favourite delights delivered to your doorstep steaming hot! We offer the best prices for
						Malaysia's best night market foods.</p>

					<ul class="list-inline footer-socials mt-4">
						<li class="list-inline-item"><a href="https://www.facebook.com"><i
									class="ti-facebook mr-2"></i></a></li>
						<li class="list-inline-item"><a href="https://wa.link/ybfh21"><i
									class="ti-themify-favicon-alt mr-2"></i></a>
						</li>
					</ul>
				</div>
			</div>

			<div class="col-lg-4 ml-auto col-md-5 mb-5 mb-lg-0">
				<div class="widget">
					<h4 class="mb-3">Contact Info</h4>

					<ul class="list-unstyled mb-0 footer-contact">
						<li><i class="ti-mobile"></i><a class="text-light" href="https://wa.link/ybfh21">+60 11-3810
								0852</a></li>
						<li><i class="ti-email"></i><a class="text-light"
								href="mailto:jumpmasterweb@gmail.com">jumpmasterweb@gmail.com</a></li>
						<li class="text-light"><i class="ti-map"></i>Kampar, Perak Malaysia</li>
					</ul>
				</div>
			</div>
			<div class="col-lg-3 col-md-4 mb-5 mb-lg-0">
				<div class="widget">
					<h4 class="mb-3">Opening Hours</h4>
					<div class="info mb-4">
						<p class="mb-0">Monday - Sunday</p>
						<h5>05:00 PM - 11:00 PM</h5>
					</div>
					<div class="info">
						<p class="mb-0">Physical Stall, Every Wednesday</p>
						<h5>05:00 PM - 11:00 PM</h5>
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<!-- Google Map Integration -->
			<div class="col-lg-4 col-md-3 mb-5 mb-lg-0">
				<span class="text-primary font-md font-extra">Location</span>
				<div class="gmap_canvas"><iframe width="372" height="206"
						src="https://maps.google.com/maps?q=Grand%20kampar%20Hotel&t=k&z=15&ie=UTF8&iwloc=&output=embed"
						frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe><a
						href="https://www.embedgooglemap.net/blog/nordvpn-coupon-code/"></a></div>
			</div>
			<!-- Google Map Integration End-->

			<div class="col-lg-8 col-md-9 mb-5 mb-lg-0">
				<div class="col-lg-12 text-center">
					<br><br>
					<span class="text-primary font-md font-extra">Get news from Jumpmaster!</span>
					<h4 class="mb-3" style="color:white;">Fill me</h4>
					<div class="form-group">
						<input id="sendemail" type="email" class="form-control" placeholder="Enter Email" required>
						<button id="emailsubmit" class="btn btn-dark">Send</button>
					</div>
				</div>
			</div>
		</div>

	</div>
</footer>
<section class="footer-btm py-3">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="d-md-flex justify-content-between align-items-center py-3 text-center text-md-left">
					<p class="mb-0 ">Copyright &copy; 2020 by <a href="index.html" class="text-white">Jumpmaster
							Night Market</a></p>

				</div>
			</div>
		</div>
	</div>
</section>
<!-- Footer  End -->



<!-- jQuery -->
<script src="plugins/jQuery/jquery.min.js"></script>
<!-- Bootstrap JS -->
<script src="plugins/bootstrap/bootstrap.min.js"></script>
<script src="plugins/aos/aos.js"></script>
<script src="plugins/shuffle/shuffle.min.js"></script>
<script src="plugins/magnific-popup/jquery.magnific-popup.min.js"></script>
<script src="plugins/date-picker/datepicker.min.js"></script>
<script src="plugins/clock-picker/clockpicker.min.js"></script>
<script src="plugins/video-popup/jquery-modal-video.min.js"></script>
<script src="plugins/swiper/swiper.min.js"></script>
<script src="plugins/bootstrap-touchpin/jquery.bootstrap-touchspin.min.js"></script>

<!-- Main Script -->
<script src="js/contact.js"></script>
<script src="js/script.js"></script>
<script src="js/user.js"></script>

<div id="UMS_TOOLTIP"
	style="position: absolute; cursor: pointer; z-index: 2147483647; background: transparent; top: -100000px; left: -100000px;">
</div>
</body>
<umsdataelement id="UMSSendDataEventElement"></umsdataelement>

<script>

	// Implement sticky header when user scrolls past header at the top
	window.onscroll = function () { myFunction1() };

	var header = document.getElementById("myheader");
	var sticky = header.offsetTop;

	function myFunction1() {
		if (window.pageYOffset > sticky) {
			header.classList.add("sticky");


		} else {
			header.classList.remove("sticky");



		}
	}

	//Function to get data from LocalStorage
	function getLocalData(name) {
		return localStorage.getItem(name)
	}

	// Function to set data into the LocalStorage
	function setLocalData(name, value) {
		if (value != null)
			localStorage.setItem(name, value);
		else
			localStorage.removeItem(name);
	}

	var cartObj = null; // global pointer to cart
	var cart = -1; //Indicates that the cart is empty
	var thequantity; // A variable to store all the quantity fields html
	var closebuttons; // A variable to store all the X buttons

	// Function to initialise cart ( If there's a cart in the LocalStorage, retrieve it.)
	// If not, just initialise an empty cart
	function cart_initCart() {
		cartObj = new Array();
		cart = 0;
		// Check in browser memory if there are a saved cart
		if (getLocalData("NETSELL5_USERCART") != null) {
			// if previoys cart is present load it
			cart = getLocalData("NETSELL5_USERCART_CI");
			cartObj = JSON.parse(getLocalData("NETSELL5_USERCART"));
			console.log(cartObj);
		}
		else {
			console.log("\tCart is empty!");
		}

	}

	// Function to update the product rows in the table
	function updateTable() {

		var table = document.getElementById("producttable");
		var subtotal = document.getElementById("subtotal");
		var vat = document.getElementById("vat");
		var grandtotal = document.getElementById("grandtotal");

		//Clear all existing html in the table body
		table.innerHTML = "";

		var objectNames;
		// Loop throw all items in the cart and initialise a row for each
		for (var i = 0; i < cartObj.length; i++) {
			if (cartObj[i] !== null) {
				var newRow = table.insertRow(i);
				var cell1 = newRow.insertCell(0);

				cell1.innerHTML = '<img src=images/products/' + cartObj[i].IMGSRC + ' alt="" class="img-fluid w-25 mr-3" id="getimage' + i + '">' + '<span class="getnames">' + cartObj[i].PRONAME + '</span>';
				cell1.classList.add("text-left");
				var cell2 = newRow.insertCell(1);
				cell2.innerHTML = '';
				var cell3 = newRow.insertCell(2);
				cell3.innerHTML = 'RM' + cartObj[i].PRICE;
				var cell4 = newRow.insertCell(3);
				cell4.innerHTML = '<td><div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-btn input-group-prepend"><input class="quantity quantity1 form-control form-control-sm" type="number" onclick="updateQuantity(' + i + ')" value="' + cartObj[i].QTORD + '" name="quantity" onkeypress="return event.charCode >= 48 && event.charCode <= 57" min="1" max="100"></div></td>';
				var cell5 = newRow.insertCell(4);
				cell5.innerHTML = '' + (parseFloat(cartObj[i].PRICE) * parseFloat(cartObj[i].QTORD)).toFixed(2);
				var cell6 = newRow.insertCell(5);
				cell6.innerHTML = '<i class="ti-close close" onclick="cart_removeCartRow_v2(' + i + ')"></i>';

			}

		}

		// Calculate values for order summary
		var totals = cart_getValue_v2();
		subtotal.innerHTML = totals['VLMERE'].toFixed(2);
		grandtotal.innerHTML = totals['VLMERE_I'].toFixed(2);
		vat.innerHTML = totals['ALIVA_VAL'].toFixed(2);
		thequantity = document.querySelectorAll(".quantity1");
		closebuttons = document.querySelectorAll(".close");
		setLocalData("TOTAL", JSON.stringify(totals));
		makebuttonswork();
	}

	// When the window has finished loading, initialise the cart, update the table and make all the quantity field and X buttons work
	$(window).ready(function () {
		cart_initCart();

		if (cart_getItemsNum_v2() != 0) {
			console.log(cart_getItemsNum_v2());
			updateTable();
			makebuttonswork();
		}

	});

	// Backup function to make the X buttons and quantity +- buttons work
	function makebuttonswork() {
		var table = document.getElementById("producttable");

		var names = document.querySelectorAll(".getnames");


	}

	// function to find the index of each item in the cart
	function findIndex(name) {
		for (var i = 0; i < cartObj.length; i++) {
			if (cartObj[i].PRONAME == name) {
				targetindex = i;
			}
		}
		return i;
	}

	// Function to update the quantity ordered of an item in the JSOn array in LocalStorage
	function updateQuantity(i) {
		var table = document.getElementById("producttable");
		var button = thequantity[i];

		if (cartObj[i].QTORD != button.value) {
			cart_updateQtordInRow_v2(i, button.value);

			table.rows[i].cells[4].innerHTML = (parseFloat(cartObj[i].PRICE) * parseFloat(cartObj[i].QTORD)).toFixed(2);
			var totals = cart_getValue_v2();
			subtotal.innerHTML = totals['VLMERE'].toFixed(2);
			grandtotal.innerHTML = totals['VLMERE_I'].toFixed(2);
			vat.innerHTML = totals['ALIVA_VAL'].toFixed(2);
			setLocalData("TOTAL", JSON.stringify(totals));
		}


	}

	//getting num items in cart
	function cart_getItemsNum_v2() {

		var itemInCart = 0;
		for (var xr in cartObj) {
			// i need index of element in this routine so i didn't used OF in iteration
			r = cartObj[xr];
			if (r == null) continue; // Removed ROW - ignore it
			itemInCart++;
		}
		return itemInCart;
	}

	// function to calculate the order summary values and returns a object array
	function cart_getValue_v2() {

		var useVAT = true;

		var kvalueVLMERE = 0.0; // without vat
		var kvalueVLMERE_I = 0.0; // with vat
		var kvalueALIVA_VAL = 0.0; // vat chargea

		for (var r of cartObj) // iterate all the item
		{
			if (r == null) continue; // Removed ROW - ignore it

			var price = parseFloat(r["PRICE"]);
			var aliva = 6.00;
			var qtord = parseFloat(r["QTORD"]);

			var totRowWithVAT = (price + ((price * aliva) / 100)) * qtord;
			var totRowNOVAT = price * qtord;
			var totRowALIVA = ((price * aliva) / 100) * qtord;

			kvalueVLMERE = kvalueVLMERE + totRowNOVAT;
			kvalueVLMERE_I = kvalueVLMERE_I + totRowWithVAT;
			kvalueALIVA_VAL = kvalueALIVA_VAL + totRowALIVA;
		}

		var cartValueObj = new Object();
		cartValueObj["VLMERE"] = kvalueVLMERE;
		cartValueObj["VLMERE_I"] = kvalueVLMERE_I;
		cartValueObj["ALIVA_VAL"] = kvalueALIVA_VAL;

		return cartValueObj;
	}


	//remove item from cart
	function cart_removeCartRow_v2(rowid) {
		// Used splice instead of delete because delete leaves a null row in the array. Splice removes the row completely
		cartObj.splice(rowid, 1);
		//Minus one from the number of obejcts in the cart
		cart--;
		setLocalData("NETSELL5_USERCART", JSON.stringify(cartObj));
		setLocalData("NETSELL5_USERCART_CI", cart);
		//Update the table whenever an item is deleted
		updateTable();
	}

	//update quantity of item in the display
	function cart_updateQtordInRow_v2(rowIndex, newQtord) {

		// update cart

		cartObj[rowIndex]["QTORD"] = newQtord;

		console.log(cartObj[rowIndex]["QTORD"]);
		// update memory
		setLocalData("NETSELL5_USERCART", JSON.stringify(cartObj));
		setLocalData("NETSELL5_USERCART_CI", cart);

	}


</script>

</html>